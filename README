
                         SeSAMe - SEnsible Step-wise Analysis of Methylation data
                     ==============================================================
                     
    Topics
    -------

        0. Introduction
        1. Install
        2. Usage
        3. Bugs
        4. About

    0. Introduction
    ---------------

    SeSAMe is an R package for processing Infinium DNA methylation data. SeSAMe
    currently supports EPIC, HM450 and HM27 platforms.

    1. Install
    ----------
    
    You need devtools from install.packages('devtools'). Then,
    > library(devtools)
    > install_github(' https://github.com/zwdzwd/sesame ')
        
    2. Usage
    --------
    
    - Load SeSAME
    
      > library(sesame)

    - Data IO
    
      To read IDATs from directory:
      > ssets <- readIDATsFromDir('IDATs/')
        
      A simple list of "SignalSet"s are returned.
        
      Other options of data import include
        
        + readIDATs - from path
        + readIDATsFromSheet - from data.frame "barcode" column
        
    - Background subtraction
    
      noob:
      > noob(sset)
      
      noob with bleed-through subtraction
      > noobsb(sset)
    
    - Dye bias correction

      linear scaling
      > dyeBiasCorr(sset)
      
      quantile interpolating Type-I probes
      > dyeBiasCorrTypeINorm(sset)
      
    - Get betas
    
      > getBetas(sset)
      use option quality.mask = TRUE/FALSE to use probe quality mask
      use option nondetection.mask = TRUE/FALSE to mask nondetection calls
        
    - Sample/experiment QC

      sex
      > inferSex(sset)

      ethnicity
      > inferEthnicity(sset)

      mean intensity
      > meanIntensity(sset)

      bisulfite conversion control
      > bisConversionControl(sset)

    - visualize probes

      > betas <- sesameGetExample('hm450.betas.TCGAnormalPAAD')

      visualize probes from a gene
      > visualizeGene('DNMT1', betas, platform='hm450')

      visualize probes from arbitrary region
      > visualizeRegion('chr19',10260000,10380000, betas, platform='hm450')

      visualize by probe names
      > visualizeProbes(c("cg02382400", "cg03738669"), betas, platform='hm450')

    - Differential methylation

      test differential methylation on each locus
      > betas <- sesameGetExample('hm450.76matchedTCGAchr20')
      > sample.info <- sesameGetExample('hm450.76matchedTCGAchr20.sampleinfo')
      > cf <- diffMeth(betas, sample.info, ~patient+type)

      top differentially methylated probes on factor "type"
      > cf1 <- cf$typeTumour
      > head(cf1[order(cf1[,'P.adjusted']),])

      segment into DMR
      > cf <- segmentDMR(betas, cf, platform = 'hm450')
      
      visualize top DMR
      > cf1 <- cf$typeTumour
      > top.dmr <- cf1[order(cf1[,'Seg.Pval']),'Seg.ID'][1]
      > visualizeProbes(rownames(cf1[cf1[,'Seg.ID']==top.dmr,]), betas,
        upstream = 5000, dwstream=5000, platform='hm450',heat.height=3.5)
      
    - CNV
    
      uses LNCaP EPIC data from GSE86833
      > example.sset <- sesameGetExample('EPIC.LNCaP.Rep1')
      > segs <- cnSegmentation(example.sset)
        
      To visualize segments,
      > visualizeSegments(segs)

    - cell composition

      Use blood set as example,
      > g <- diffRefSet(getRefSet(c('CD4T','CD19B','CD14Monocytes','CD56NK',
         'granulocytes'), platform='hm450'))
      > betas <- sesameGetExample('TCGA-2L-AAQA-01A-21D-A38H-05')
      > estimateCellComposition(g, betas[rownames(g)])$frac

    3. Bugs
    -------
    
    Bug reports are appreciated. Register issues at the sesame issue tracker
    
                       < http://github.com/zwdzwd/sesame/issues >
    
    
    4. About
    --------
    
    This was a collaborative project by Wanding Zhou, Hui Shen and Peter W Laird
    from the Van Andel Research Institute.
    
